const cardsData = [
    {
        id: 'blue1',
        cardFace: "./assets/MythicCards/blue/blue1.png",
        difficulty: 'hard',
        color: 'blue'
    },
    {
        id: 'blue2',
        cardFace: "./assets/MythicCards/blue/blue2.png",
        difficulty: 'hard',
        color: 'blue'
    },
    {
        id: 'blue3',
        cardFace: "./assets/MythicCards/blue/blue3.png",
        difficulty: 'easy',
        color: 'blue'
    },
    {
        id: 'blue4',
        cardFace: "./assets/MythicCards/blue/blue4.png",
        difficulty: 'easy',
        color: 'blue'
    },
    {
        id: 'blue5',
        cardFace: "./assets/MythicCards/blue/blue5.png",
        difficulty: 'easy',
        color: 'blue'
    },
    {
        id: 'blue6',
        cardFace: "./assets/MythicCards/blue/blue6.png",
        difficulty: 'hard',
        color: 'blue'
    },
    {
        id: 'blue7',
        cardFace: "./assets/MythicCards/blue/blue7.png",
        difficulty: 'normal',
        color: 'blue'
    },
    {
        id: 'blue8',
        cardFace: "./assets/MythicCards/blue/blue8.png",
        difficulty: 'hard',
        color: 'blue'
    },
    {
        id: 'blue9',
        cardFace: "./assets/MythicCards/blue/blue9.png",
        difficulty: 'normal',
        color: 'blue'
    },
    {
        id: 'blue10',
        cardFace: "./assets/MythicCards/blue/blue10.png",
        difficulty: 'easy',
        color: 'blue'
    },
    {
        id: 'blue11',
        cardFace: "./assets/MythicCards/blue/blue11.png",
        difficulty: 'normal',
        color: 'blue'
    },
    {
        id: 'blue12',
        cardFace: "./assets/MythicCards/blue/blue12.png",
        difficulty: 'normal',
        color: 'blue'
    },

    {
        id: 'brown1',
        cardFace: "./assets/MythicCards/brown/brown1.png",
        difficulty: 'normal',
        color: 'brown'
    },
    {
        id: 'brown2',
        cardFace: "./assets/MythicCards/brown/brown2.png",
        difficulty: 'normal',
        color: 'brown'
    },
    {
        id: 'brown3',
        cardFace: "./assets/MythicCards/brown/brown3.png",
        difficulty: 'normal',
        color: 'brown'
    },
    {
        id: 'brown4',
        cardFace: "./assets/MythicCards/brown/brown4.png",
        difficulty: 'normal',
        color: 'brown'
    },
    {
        id: 'brown5',
        cardFace: "./assets/MythicCards/brown/brown5.png",
        difficulty: 'normal',
        color: 'brown'
    },
    {
        id: 'brown6',
        cardFace: "./assets/MythicCards/brown/brown6.png",
        difficulty: 'hard',
        color: 'brown'
    },
    {
        id: 'brown7',
        cardFace: "./assets/MythicCards/brown/brown7.png",
        difficulty: 'hard',
        color: 'brown'
    },
    {
        id: 'brown8',
        cardFace: "./assets/MythicCards/brown/brown8.png",
        difficulty: 'hard',
        color: 'brown'
    },
    {
        id: 'brown9',
        cardFace: "./assets/MythicCards/brown/brown9.png",
        difficulty: 'hard',
        color: 'brown'
    },
    {
        id: 'brown10',
        cardFace: "./assets/MythicCards/brown/brown10.png",
        difficulty: 'hard',
        color: 'brown'
    },
    {
        id: 'brown11',
        cardFace: "./assets/MythicCards/brown/brown11.png",
        difficulty: 'easy',
        color: 'brown'
    },
    {
        id: 'brown12',
        cardFace: "./assets/MythicCards/brown/brown12.png",
        difficulty: 'easy',
        color: 'brown'
    },
    {
        id: 'brown13',
        cardFace: "./assets/MythicCards/brown/brown13.png",
        difficulty: 'easy',
        color: 'brown'
    },
    {
        id: 'brown14',
        cardFace: "./assets/MythicCards/brown/brown14.png",
        difficulty: 'easy',
        color: 'brown'
    },
    {
        id: 'brown15',
        cardFace: "./assets/MythicCards/brown/brown15.png",
        difficulty: 'normal',
        color: 'brown'
    },
    {
        id: 'brown16',
        cardFace: "./assets/MythicCards/brown/brown16.png",
        difficulty: 'normal',
        color: 'brown'
    },
    {
        id: 'brown17',
        cardFace: "./assets/MythicCards/brown/brown17.png",
        difficulty: 'normal',
        color: 'brown'
    },
    {
        id: 'brown18',
        cardFace: "./assets/MythicCards/brown/brown18.png",
        difficulty: 'normal',
        color: 'brown'
    },
    {
        id: 'brown19',
        cardFace: "./assets/MythicCards/brown/brown19.png",
        difficulty: 'normal',
        color: 'brown'
    },
    {
        id: 'brown20',
        cardFace: "./assets/MythicCards/brown/brown20.png",
        difficulty: 'normal',
        color: 'brown'
    },
    {
        id: 'brown21',
        cardFace: "./assets/MythicCards/brown/brown21.png",
        difficulty: 'easy',
        color: 'brown'
    },

    {
        id: 'green1',
        cardFace: "./assets/MythicCards/green/green1.png",
        difficulty: 'easy',
        color: 'green'
    },
    {
        id: 'green2',
        cardFace: "./assets/MythicCards/green/green2.png",
        difficulty: 'hard',
        color: 'green'
    },
    {
        id: 'green3',
        cardFace: "./assets/MythicCards/green/green3.png",
        difficulty: 'hard',
        color: 'green'
    },
    {
        id: 'green4',
        cardFace: "./assets/MythicCards/green/green4.png",
        difficulty: 'hard',
        color: 'green'
    },
    {
        id: 'green5',
        cardFace: "./assets/MythicCards/green/green5.png",
        difficulty: 'hard',
        color: 'green'
    },
    {
        id: 'green6',
        cardFace: "./assets/MythicCards/green/green6.png",
        difficulty: 'hard',
        color: 'green'
    },
    {
        id: 'green7',
        cardFace: "./assets/MythicCards/green/green7.png",
        difficulty: 'normal',
        color: 'green'
    },
    {
        id: 'green8',
        cardFace: "./assets/MythicCards/green/green8.png",
        difficulty: 'normal',
        color: 'green'
    },
    {
        id: 'green9',
        cardFace: "./assets/MythicCards/green/green9.png",
        difficulty: 'normal',
        color: 'green'
    },
    {
        id: 'green10',
        cardFace: "./assets/MythicCards/green/green10.png",
        difficulty: 'normal',
        color: 'green'
    },
    {
        id: 'green11',
        cardFace: "./assets/MythicCards/green/green11.png",
        difficulty: 'normal',
        color: 'green'
    },
    {
        id: 'green12',
        cardFace: "./assets/MythicCards/green/green12.png",
        difficulty: 'easy',
        color: 'green'
    },
    {
        id: 'green13',
        cardFace: "./assets/MythicCards/green/green13.png",
        difficulty: 'normal',
        color: 'green'
    },
    {
        id: 'green14',
        cardFace: "./assets/MythicCards/green/green14.png",
        difficulty: 'normal',
        color: 'green'
    },
    {
        id: 'green15',
        cardFace: "./assets/MythicCards/green/green15.png",
        difficulty: 'normal',
        color: 'green'
    },
    {
        id: 'green16',
        cardFace: "./assets/MythicCards/green/green16.png",
        difficulty: 'easy',
        color: 'green'
    },
    {
        id: 'green17',
        cardFace: "./assets/MythicCards/green/green17.png",
        difficulty: 'easy',
        color: 'green'
    },
    {
        id: 'green18',
        cardFace: "./assets/MythicCards/green/green18.png",
        difficulty: 'easy',
        color: 'green'
    },
]

const ancientsData = [
    {
        id: 'azathoth',
        name: 'azathoth',
        cardFace: './assets/Ancients/Azathoth.png',
        firstStage: {
            greenCards: 1,
            blueCards: 1,
            brownCards: 2,
        },
        secondStage: {
            greenCards: 2,
            blueCards: 1,
            brownCards: 3,
        },
        thirdStage: {
            greenCards: 2,
            blueCards: 0,
            brownCards: 4,
        },
    },
    {
        id: 'cthulhu',
        name: 'cthulhu',
        cardFace: './assets/Ancients/Cthulhu.png',
        firstStage: {
            greenCards: 0,
            blueCards: 2,
            brownCards: 2,
        },
        secondStage: {
            greenCards: 1,
            blueCards: 0,
            brownCards: 3,
        },
        thirdStage: {
            greenCards: 3,
            blueCards: 0,
            brownCards: 4,
        },
    },
    {
        id: 'iogSothoth',
        name: 'iogSothoth',
        cardFace: './assets/Ancients/iogSothoth.png',
        firstStage: {
            greenCards: 0,
            blueCards: 1,
            brownCards: 2,
        },
        secondStage: {
            greenCards: 2,
            blueCards: 1,
            brownCards: 3,
        },
        thirdStage: {
            greenCards: 3,
            blueCards: 0,
            brownCards: 4,
        },
    },
    {
        id: 'shubNiggurath',
        name: 'shubNiggurath',
        cardFace: './assets/Ancients/shubNiggurath.png',
        firstStage: {
            greenCards: 1,
            blueCards: 1,
            brownCards: 2,
        },
        secondStage: {
            greenCards: 3,
            blueCards: 1,
            brownCards: 2,
        },
        thirdStage: {
            greenCards: 2,
            blueCards: 0,
            brownCards: 4,
        },
    },
]

let dataVeryEasy = cardsData.filter(item => item.difficulty === 'easy');
let dataEasy = cardsData.filter(item => item.difficulty === 'easy' || item.difficulty === 'normal');
let dataNormal = cardsData.filter(item => item.difficulty === 'normal');
let dataHard = cardsData.filter(item => item.difficulty === 'normal' || item.difficulty === 'hard');
let dataVeryHard = cardsData.filter(item => item.difficulty === 'hard');

//Ancients
// выбор древнего

const azathoth = document.querySelector('.azathoth');
const cthulhu = document.querySelector('.cthulhu');
const iogSothoth = document.querySelector('.iogSothoth');
const shubNiggurath = document.querySelector('.shubNiggurath');
const difficultyLevel = document.querySelector('.difficultyLevel');
const kneadDeck = document.querySelector('.kneadDeck');


let ancients = '';
let diffLevel = '';

let selectedAncient;

function activeAzathoth() {
    azathoth.innerHTML = '';
    cthulhu.innerHTML = '';
    iogSothoth.innerHTML = '';
    shubNiggurath.innerHTML = '';
    azathoth.innerHTML = "<img src=\"./assets/frame.png\" width=\"100%\" height=\"100%\" alt=\"Azathoth\"></img>";
    difficultyLevel.classList.add('openDiff');
    counter.classList.remove('openDiff');
    cardBackground.classList.remove('openDiff');
    droppedCard.classList.remove('openDiff');
    ancients = 'azathoth';
    selectedAncient = ancientsData.find(item => item.id === ancients);
}

function activeCthulhu() {
    azathoth.innerHTML = '';
    cthulhu.innerHTML = '';
    iogSothoth.innerHTML = '';
    shubNiggurath.innerHTML = '';
    cthulhu.innerHTML = "<img src=\"./assets/frame.png\" width=\"100%\" height=\"100%\" alt=\"Azathoth\"></img>";
    difficultyLevel.classList.add('openDiff');
    counter.classList.remove('openDiff');
    cardBackground.classList.remove('openDiff');
    droppedCard.classList.remove('openDiff');
    ancients = 'cthulhu';
    selectedAncient = ancientsData.find(item => item.id === ancients);
}

function activeIogSothoth() {
    azathoth.innerHTML = '';
    cthulhu.innerHTML = '';
    iogSothoth.innerHTML = '';
    shubNiggurath.innerHTML = '';
    iogSothoth.innerHTML = "<img src=\"./assets/frame.png\" width=\"100%\" height=\"100%\" alt=\"Azathoth\"></img>";
    difficultyLevel.classList.add('openDiff');
    counter.classList.remove('openDiff');
    cardBackground.classList.remove('openDiff');
    droppedCard.classList.remove('openDiff');
    ancients = 'iogSothoth';
    selectedAncient = ancientsData.find(item => item.id === ancients);
}

function activeShubNiggurath() {
    azathoth.innerHTML = '';
    cthulhu.innerHTML = '';
    iogSothoth.innerHTML = '';
    shubNiggurath.innerHTML = '';
    shubNiggurath.innerHTML = "<img src=\"./assets/frame.png\" width=\"100%\" height=\"100%\" alt=\"Azathoth\"></img>";
    difficultyLevel.classList.add('openDiff');
    counter.classList.remove('openDiff');
    cardBackground.classList.remove('openDiff');
    droppedCard.classList.remove('openDiff');
    ancients = 'shubNiggurath';
    selectedAncient = ancientsData.find(item => item.id === ancients);
}

azathoth.addEventListener('click', activeAzathoth);
cthulhu.addEventListener('click', activeCthulhu);
iogSothoth.addEventListener('click', activeIogSothoth);
shubNiggurath.addEventListener('click', activeShubNiggurath);

//difficulty Level

const veryEasy = document.querySelector('.veryEasy');
const easy = document.querySelector('.easy');
const normal = document.querySelector('.normal');
const hard = document.querySelector('.hard');
const veryHard = document.querySelector('.veryHard');


function veryEasyActive() {
    veryEasy.classList.remove('diffActive');
    easy.classList.remove('diffActive');
    normal.classList.remove('diffActive');
    hard.classList.remove('diffActive');
    veryHard.classList.remove('diffActive');
    veryEasy.classList.add('diffActive');
    kneadDeck.classList.add('openDiff');
    counter.classList.remove('openDiff');
    cardBackground.classList.remove('openDiff');
    droppedCard.classList.remove('openDiff');
    diffLevel = 'veryEasy';
}

function easyActive() {
    veryEasy.classList.remove('diffActive');
    easy.classList.remove('diffActive');
    normal.classList.remove('diffActive');
    hard.classList.remove('diffActive');
    veryHard.classList.remove('diffActive');
    easy.classList.add('diffActive');
    kneadDeck.classList.add('openDiff');
    counter.classList.remove('openDiff');
    cardBackground.classList.remove('openDiff');
    droppedCard.classList.remove('openDiff');
    diffLevel = 'easy';
}

function normalActive() {
    veryEasy.classList.remove('diffActive');
    easy.classList.remove('diffActive');
    normal.classList.remove('diffActive');
    hard.classList.remove('diffActive');
    veryHard.classList.remove('diffActive');
    normal.classList.add('diffActive');
    kneadDeck.classList.add('openDiff');
    counter.classList.remove('openDiff');
    cardBackground.classList.remove('openDiff');
    droppedCard.classList.remove('openDiff');
    diffLevel = 'normal';
}

function hardActive() {
    veryEasy.classList.remove('diffActive');
    easy.classList.remove('diffActive');
    normal.classList.remove('diffActive');
    hard.classList.remove('diffActive');
    veryHard.classList.remove('diffActive');
    hard.classList.add('diffActive');
    kneadDeck.classList.add('openDiff');
    counter.classList.remove('openDiff');
    cardBackground.classList.remove('openDiff');
    droppedCard.classList.remove('openDiff');
    diffLevel = 'hard';
}

function veryHardActive() {
    veryEasy.classList.remove('diffActive');
    easy.classList.remove('diffActive');
    normal.classList.remove('diffActive');
    hard.classList.remove('diffActive');
    veryHard.classList.remove('diffActive');
    veryHard.classList.add('diffActive');
    kneadDeck.classList.add('openDiff');
    counter.classList.remove('openDiff');
    cardBackground.classList.remove('openDiff');
    droppedCard.classList.remove('openDiff');
    diffLevel = 'veryHard';
}

veryEasy.addEventListener('click', veryEasyActive);
easy.addEventListener('click', easyActive);
normal.addEventListener('click', normalActive);
hard.addEventListener('click', hardActive);
veryHard.addEventListener('click', veryHardActive);


function shuffle(array) {
    for (let i = array.length - 1; i > 0; i--) {
      let j = Math.floor(Math.random() * (i + 1)); 
      [array[i], array[j]] = [array[j], array[i]];
    }
  }

let greenPullarr = [];

function greenPull() {
    let countGreen = selectedAncient.firstStage.greenCards + selectedAncient.secondStage.greenCards + selectedAncient.thirdStage.greenCards;
    let dataNormalGreen = dataNormal.filter(item => item.color === 'green');
    shuffle(dataNormalGreen);
    if (diffLevel === 'veryEasy') {
        greenPullarr = dataVeryEasy.filter(item => item.color === 'green');

        if (greenPullarr.length < countGreen) {
            let i = 1;
            while (greenPullarr.length < countGreen) {
                
                greenPullarr.push(dataNormalGreen[i]);
                i++
            }
        }
    } else if (diffLevel === 'easy') {

    }
    shuffle(greenPullarr);
}

let brownPullarr;


function brownPull() {
    let countBrown = selectedAncient.firstStage.brownCards + selectedAncient.secondStage.brownCards + selectedAncient.thirdStage.brownCards;
    let dataNormalBrown = dataNormal.filter(item => item.color === 'brown');
    shuffle(dataNormalBrown);
    if (diffLevel === 'veryEasy') {
        brownPullarr = dataVeryEasy.filter(item => item.color === 'brown');
    
        let i = 1;
        if (brownPullarr.length < countBrown) {
            while (brownPullarr.length < countBrown) {
                brownPullarr.push(dataNormalBrown[i]);
                i++;
            }
        }
    }
    shuffle(brownPullarr);
}


let bluePullarr = [];


function bluePull() {
    let countBlue = selectedAncient.firstStage.blueCards + selectedAncient.secondStage.blueCards + selectedAncient.thirdStage.blueCards;
    let dataNormalBlue = dataNormal.filter(item => item.color === 'blue');
    shuffle(dataNormalBlue);
    if (diffLevel === 'veryEasy') {
        bluePullarr = dataVeryEasy.filter(item => item.color === 'blue');
        if (bluePullarr.length < countBlue) {
            let i = 1;
            while (bluePullarr.length < countBlue) {
                
                bluePullarr.push(dataNormalBlue[i]);
                i++;
            }
        }
    }
    shuffle(bluePullarr);
}

let FSGreen = document.querySelector('.firstStage .green');
let greenCounterFS = 0;
let FSBrown = document.querySelector('.firstStage .brown');
let brownCounterFS = 0;
let FSBlue = document.querySelector('.firstStage .blue');
let blueCounterFS = 0;
let SSGreen = document.querySelector('.secondStage .green');
let greenCounterSS = 0;
let SSBrown = document.querySelector('.secondStage .brown');
let brownCounterSS = 0;
let SSBlue = document.querySelector('.secondStage .blue');
let blueCounterSS = 0;
let TSGreen = document.querySelector('.thirdStage .green');
let greenCounterTS = 0;
let TSBrown = document.querySelector('.thirdStage .brown');
let brownCounterTS = 0;
let TSBlue = document.querySelector('.thirdStage .blue');
let blueCounterTS = 0;

let firstStage = [];
let secondStage = [];
let thirdStage = [];



//Замешиваем колоду
//Очень легкий уровень сложности


const counter = document.querySelector('.counter');
const cardBackground = document.querySelector('.cardBackground');
const droppedCard = document.querySelector('.droppedCard');

function startKneadDeck() {
    let FSGreen = document.querySelector('.firstStage .green');
    greenCounterFS = 0;
    brownCounterFS = 0;
    blueCounterFS = 0;
    greenCounterSS = 0;
    brownCounterSS = 0;
    blueCounterSS = 0;
    greenCounterTS = 0;
    brownCounterTS = 0;
    blueCounterTS = 0;

    greenPullarr = [];
    brownPullarr = [];
    bluePullarr = [];

    greenPull();
    brownPull();
    bluePull();



    firstStage = [];
    secondStage = [];
    thirdStage = [];

    for (let i = 0; i < selectedAncient.firstStage.greenCards; i++) {
        firstStage.push(greenPullarr.pop());
        greenCounterFS++;
    }

    for (let i = 0; i < selectedAncient.firstStage.brownCards; i++) {
        firstStage.push(brownPullarr.pop());
        brownCounterFS++;
    }
    for (let i = 0; i < selectedAncient.firstStage.blueCards; i++) {
        firstStage.push(bluePullarr.pop());
        blueCounterFS++;
    }
    for (let i = 0; i < selectedAncient.secondStage.greenCards; i++) {
        secondStage.push(greenPullarr.pop());
        greenCounterSS++;
    }
    for (let i = 0; i < selectedAncient.secondStage.brownCards; i++) {
        secondStage.push(brownPullarr.pop());
        brownCounterSS++;
    }
    for (let i = 0; i < selectedAncient.secondStage.blueCards; i++) {
        secondStage.push(bluePullarr.pop());
        blueCounterSS++;
    }
    for (let i = 0; i < selectedAncient.thirdStage.greenCards; i++) {
        thirdStage.push(greenPullarr.pop());
        greenCounterTS++;
    }
    for (let i = 0; i < selectedAncient.thirdStage.brownCards; i++) {
        thirdStage.push(brownPullarr.pop());
        brownCounterTS++;
    }
    for (let i = 0; i < selectedAncient.thirdStage.blueCards; i++) {
        thirdStage.push(bluePullarr.pop());
        blueCounterTS++;
    }
    shuffle(firstStage);
    shuffle(secondStage);
    shuffle(thirdStage);
    kneadDeck.classList.remove('openDiff');
    counter.classList.add('openDiff');
    cardBackground.classList.add('openDiff');
    droppedCard.classList.add('openDiff');
    FSGreen.textContent = greenCounterFS;
    FSBrown.textContent = brownCounterFS;
    FSBlue.textContent = blueCounterFS
    SSGreen.textContent = greenCounterSS;
    SSBrown.textContent = brownCounterSS;
    SSBlue.textContent = blueCounterSS;
    TSGreen.textContent = greenCounterTS;
    TSBrown.textContent = brownCounterTS;
    TSBlue.textContent = blueCounterTS;
    console.log(firstStage);
    console.log(secondStage);
    console.log(thirdStage);
}

kneadDeck.addEventListener('click', startKneadDeck);


function droppedCards() {
    if (firstStage.length > 0) {
        droppedCard.innerHTML = `<img src="${firstStage[firstStage.length - 1].cardFace}" alt="card" width="170px">`;
        if (firstStage[firstStage.length - 1].color === "green") {
            greenCounterFS--;
            FSGreen.innerHTML = greenCounterFS;
        } else if (firstStage[firstStage.length - 1].color === "blue") {
            blueCounterFS--;
            FSBlue.innerHTML = blueCounterFS;
        } else if (firstStage[firstStage.length - 1].color === "brown") {
            brownCounterFS--;
            FSBrown.innerHTML = brownCounterFS;
        }
        firstStage.pop();
    } else if (secondStage.length > 0) {
        droppedCard.innerHTML = `<img src="${secondStage[secondStage.length - 1].cardFace}" alt="card" width="170px">`;
        if (secondStage[secondStage.length - 1].color === "green") {
            greenCounterSS--;
            SSGreen.innerHTML = greenCounterSS;
        } else if (secondStage[secondStage.length - 1].color === "blue") {
            blueCounterSS--;
            SSBlue.innerHTML = blueCounterSS;
        } else if (secondStage[secondStage.length - 1].color === "brown") {
            brownCounterSS--;
            SSBrown.innerHTML = brownCounterSS;
        }
        secondStage.pop();
    } else if (thirdStage.length > 0) {
        droppedCard.innerHTML = `<img src="${thirdStage[thirdStage.length - 1].cardFace}" alt="card" width="170px">`;
        if (thirdStage[thirdStage.length - 1].color === "green") {
            greenCounterTS--;
            TSGreen.innerHTML = greenCounterTS;
        } else if (thirdStage[thirdStage.length - 1].color === "blue") {
            blueCounterTS--;
            TSBlue.innerHTML = blueCounterTS;
        } else if (thirdStage[thirdStage.length - 1].color === "brown") {
            brownCounterTS--;
            TSBrown.innerHTML = brownCounterTS;
        }
        thirdStage.pop();
    }

}

cardBackground.addEventListener('click', droppedCards);
